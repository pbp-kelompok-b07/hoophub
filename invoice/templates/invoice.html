{% extends 'base.html' %}
{% load static %}

{% block meta %}
<title>hoophub â€” Invoices</title>
{% endblock meta %}

{% block content %}
{% include 'navbar.html' %}

<main>
  <div class="pt-[130px] px-[40px]">
    <h2 style="padding: 0px 50px 0px 50px; font-weight: 700; color: #000; font-size:20px">
      Track your past orders!
    </h2>
    <hr style="border: none; border-top: 2px dashed #005F73; margin: 10px 50px 30px 50px;">

    {% if user.is_authenticated %}
      {% if invoices %}
        {% for inv in invoices %}
          <div style="background-color: #E0E0E0; border-radius: 16px; padding: 20px 30px; margin: 0 auto 20px auto; width: 95%; min-height: 200px;">
            <div style="display: flex; justify-content: space-between; align-items: center; gap: 16px;">
              
              <!-- Kiri: gambar + info produk -->
              <div style="display: flex; align-items: flex-start; gap: 16px;">
                {% if inv.product.image %}
                  <img src="{{ inv.product.image.url }}"
                       alt="{{ inv.product.name }}"
                       style="width: 120px; height: 120px; object-fit: cover; border-radius: 10px;">
                {% endif %}

                <div>
                  <h3 style="font-weight: 700; margin: 0;">
                    {{ inv.product.brand|default_if_none:"" }} {{ inv.product.name }}
                  </h3>
                  <p style="color: #4A4A4A; margin: 6px 0 10px 0; white-space: pre-line;">
                    {{ inv.product.subtitle|default:"" }}
                  </p>

                  <p style="font-weight: 700; margin: 0 0 8px 0;">
                    â‚¹{{ inv.product.price|floatformat:2 }}
                  </p>

                  <p style="color: #555; max-width: 720px; margin: 0;">
                    {{ inv.product.description|default:"Inspired by the team's redeeming run in Beijing, this edition of the Kobe 4 Protro returns with the same winning spirit.." }}
                  </p>
                </div>
              </div>

              <!-- Kanan: aksi -->
              <div style="display: flex; gap: 10px; flex-shrink: 0;">
                <form action="{% url 'invoice:reorder' inv.id %}" method="post">
                  {% csrf_token %}
                  <button type="submit"
                          style="background-color: #EE9B00; color: white; padding: 6px 16px; border-radius: 99px; font-weight: 500; border: none; cursor: pointer; box-shadow: 0 2px 4px rgba(0,0,0,0.2);">
                    Order again
                  </button>
                </form>

                <form action="{% url 'invoice:delete' inv.id %}" method="post" onsubmit="return confirm('Delete this invoice?')">
                  {% csrf_token %}
                  <button type="submit"
                          style="background-color: #BB3E03; color: white; padding: 6px 16px; border-radius: 99px; font-weight: 500; border: none; cursor: pointer; box-shadow: 0 2px 4px rgba(0,0,0,0.2);">
                    Delete
                  </button>
                </form>
              </div>
            </div>
          </div>
        {% endfor %}
      {% else %}
        <p style="padding: 0px 50px; color: #666;">No invoices yet.</p>
      {% endif %}
    {% else %}
      <p style="padding: 0px 50px; color: #666;">You are not logged in ðŸ˜…</p>
      <div style="padding: 10px 50px;">
        <a href="{% url 'authentication:login' %}"
           style="background-color: #EE9B00; color: white; padding: 6px 16px; border-radius: 99px; font-weight: 500; text-decoration: none; display: inline-block; box-shadow: 0 2px 4px rgba(0,0,0,0.2);">
          Login Now
        </a>
      </div>
    {% endif %}
  </div>
</main>

{% endblock content %}
